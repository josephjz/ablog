{% extends 'base.html' %}

{% block title %}
{{post.title_tag}}
{% endblock %}
<!-- this will be the page displayed when you click the specific blog post  -->

{% block content %}
<!-- current user: {{ user.id }} because we are logged in  -->
<!-- poster: {{ post.author.id }}  -->

<h1>{{post.title}}</h1> 
<small> By: {{post.author.first_name}} {{post.author.last_name}} </small> <br>
<small> Date: {{post.post_date}} </small>

{% if user.is_authenticated %} <!-- first check that they are a valid user aka logged in -->
    {% if user.id == post.author.id %} <!-- then if this post we are looking at was posted by the user logged in -->
        <a href = "{% url 'update-post' post.pk %}"><small>[Edit]</small></a> <a href = "{% url 'delete-post' post.pk %}"><small>[Delete]</small></a>
    {% endif %}
{% endif %}

<hr>
{{ post.body|safe }}
<br>
<hr>

<form action="{% url 'like-post' post.pk%}" method = "POST"}>   <!-- passing post.pk rememebrs which post we are looking at -->
<!-- remember that for all forms we need a csrf token  -->
{% csrf_token %}    

<!-- value = "{{post.id}}" passes the post to the backend to know where to put the like -->

{% if user.is_authenticated %}
    {% if liked %}
        <button type = "submit", name = "post_id", value = "{{post.id}}", class = "btn btn-danger btn-sm">Unlike</button>  
    {% else %}
        <button type = "submit", name = "post_id", value = "{{post.id}}", class = "btn btn-primary btn-sm">Like</button>  
    {% endif %}
{% else %}
You must be logged in to like posts
{% endif %}
<br>
{{total_likes}} Likes

</form>
<br>
<!-- without the class = this is a hyperlink, adding class makes it a bootstrap button  -->
<a href= "{% url 'home' %}" class = "btn btn-secondary btn-small">Back</a>    

{% endblock %}